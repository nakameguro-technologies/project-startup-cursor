---
title: "機能要件"
version: "1.2"
last_updated: "2025-01-28"
author: "takumi kumagai"
reviewers: []
related_docs: ["02_business_requirements.md", "04_non_functional_requirements.md"]
status: "draft"
dependencies:
  upstream: ["02_business_requirements.md"]
  downstream: ["02_design/02_application_design.md"]
impact_level: "high"
---

# 機能要件

## 1. 機能概要

### 1.1 対象機能
- ToDoアイテムの管理（追加・編集・削除・完了チェック）
- データの永続化（ローカルストレージ）

### 1.2 機能範囲
- **実装対象**: 基本的なCRUD操作、ローカルストレージ連携、CSV出力
- **実装対象外**: カテゴリ分け、優先度設定、期限管理、フィルタリング

## 2. 詳細機能要件

### 2.1 ToDoアイテム管理機能

#### FR001: ToDoアイテム追加機能
- **概要**: 新しいToDoアイテムを追加する
- **入力**: ToDoアイテムのタイトル（テキスト）
- **処理**: 
  - 入力されたタイトルで新しいToDoアイテムを作成
  - 一意のIDを自動生成
  - 完了状態を未完了で初期化
  - リストに追加して表示
- **出力**: 更新されたToDoリスト
- **制約**: 
  - タイトルは必須入力
  - 空白のみの入力は不可
  - 最大文字数: 100文字

#### FR002: ToDoアイテム削除機能
- **概要**: 既存のToDoアイテムを削除する
- **入力**: 削除対象のToDoアイテムID
- **処理**: 
  - 指定されたIDのToDoアイテムをリストから削除
  - ローカルストレージを更新
- **出力**: 更新されたToDoリスト
- **制約**: 存在しないIDの場合はエラーハンドリング

#### FR003: ToDoアイテム完了チェック機能
- **概要**: ToDoアイテムの完了状態を切り替える
- **入力**: 対象ToDoアイテムのID
- **処理**: 
  - 指定されたToDoアイテムの完了状態を反転
  - 完了状態に応じた表示スタイルの変更
  - ローカルストレージを更新
- **出力**: 更新された完了状態とToDoリスト
- **制約**: 存在しないIDの場合はエラーハンドリング

#### FR004: ToDoアイテム編集機能
- **概要**: 既存のToDoアイテムのタイトルを編集する
- **入力**: 
  - 編集対象のToDoアイテムID
  - 新しいタイトル（テキスト）
- **処理**: 
  - 指定されたIDのToDoアイテムのタイトルを更新
  - ローカルストレージを更新
- **出力**: 更新されたToDoリスト
- **制約**: 
  - タイトルは必須入力
  - 空白のみの入力は不可
  - 存在しないIDの場合はエラーハンドリング

### 2.2 データ永続化機能

#### FR005: データ保存機能
- **概要**: ToDoリストをローカルストレージに保存する
- **入力**: ToDoリストデータ
- **処理**: 
  - ToDoリストをJSON形式でシリアライズ
  - ローカルストレージに保存
- **出力**: 保存完了
- **制約**: 
  - ローカルストレージの容量制限内での動作
  - JSON形式での保存

#### FR006: データ読み込み機能
- **概要**: ローカルストレージからToDoリストを読み込む
- **入力**: なし（アプリケーション起動時）
- **処理**: 
  - ローカルストレージからデータを取得
  - JSON形式をデシリアライズ
  - ToDoリストの状態を復元
- **出力**: 復元されたToDoリスト
- **制約**: 
  - データが存在しない場合は空のリストで初期化
  - 不正なデータ形式の場合は空のリストで初期化

### 2.3 データエクスポート機能

#### FR007: CSV出力機能
- **概要**: ToDoリストの内容をCSV形式でエクスポートする
- **入力**: 現在のToDoリストデータ
- **処理**: 
  - ToDoアイテムをCSV形式に変換
  - ヘッダー行を含むCSV文字列を生成
  - ブラウザのダウンロード機能でファイル保存
- **出力**: CSVファイル（todos_[YYYY-MM-DD].csv）
- **制約**: 
  - UTF-8エンコーディングで出力
  - RFC 4180準拠のCSV形式
  - ファイル名は日付付きで自動生成
- **CSVフォーマット**:
  ```
  ID,タイトル,完了状態,作成日時,更新日時
  "abc123","買い物に行く","未完了","2025-01-28 10:00:00","2025-01-28 10:00:00"
  "def456","レポート作成","完了","2025-01-28 11:00:00","2025-01-28 12:00:00"
  ```

## 3. データ構造

### 3.1 ToDoアイテム
```typescript
interface TodoItem {
  id: string;          // 一意識別子
  title: string;       // タイトル
  completed: boolean;  // 完了状態
  createdAt: Date;     // 作成日時
  updatedAt: Date;     // 更新日時
}
```

### 3.2 ToDoリスト
```typescript
interface TodoList {
  items: TodoItem[];   // ToDoアイテムの配列
}
```

## 4. ユースケース

### 4.1 基本ユースケース
1. **新しいToDoを追加する**
   - ユーザーがタイトルを入力
   - 「追加」ボタンをクリック
   - ToDoがリストに表示される

2. **ToDoを完了にする**
   - ユーザーがチェックボックスをクリック
   - ToDoが完了状態に変更される
   - 表示スタイルが変更される

3. **ToDoを編集する**
   - ユーザーが編集ボタンをクリック
   - タイトルが編集可能になる
   - 新しいタイトルを入力して保存

4. **ToDoを削除する**
   - ユーザーが削除ボタンをクリック
   - ToDoがリストから削除される

5. **ToDoリストをCSV出力する**
   - ユーザーがCSV出力ボタンをクリック
   - ToDoリストがCSV形式でダウンロードされる
   - ファイル名は日付付きで自動生成される

## 5. 非機能要件への影響

### 5.1 性能要件
- ローカルストレージの読み書き性能
- リスト表示の応答性

### 5.2 使いやすさ要件
- 直感的な操作性
- 視覚的なフィードバック

## 更新履歴

| バージョン | 更新日 | 更新者 | 更新内容 | 影響ドキュメント |
|---|-----|-----|----|---|
| 1.0 | 2025-06-18 | takumi kumagai | 初版作成 | 04_non_functional_requirements.md, 02_design/ |
| 1.1 | 2025-01-27 | takumi kumagai | 文字数制限を100文字に設定 | - |
| 1.2 | 2025-01-28 | takumi kumagai | CSV出力機能追加 | 02_design/02_application_design.md | 